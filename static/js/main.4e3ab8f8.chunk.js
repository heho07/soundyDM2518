(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{149:function(e,t,a){e.exports=a(296)},154:function(e,t,a){},296:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(104),s=a.n(o),i=a(106),c=(a(154),a(4)),l=a(5),u=a(7),d=a(6),h=a(8),m=(a(48),a(3)),p=(a(31),function(e){m.auth().onAuthStateChanged(function(t){e.push(t?"/TabContainer":"/login")})}),f=a(1),g=(a(22),a(23),new m.auth.GoogleAuthProvider),E=new m.auth.FacebookAuthProvider,b=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).signInWithGoogle=function(){m.auth().signInWithPopup(g).then(function(e){e.credential.accessToken,e.user}).catch(function(e){var t=e.code,n=e.message,r=e.email,o=e.credential;console.log("error with Google-sign in: Message: "+n+"Code: "+t+" email: "+r);a.props.createErrorMessage("There was en error signing in with Google. See the log for detailed information.","Toast"),console.log(o)})},a.signInWithFacebook=function(){m.auth().signInWithPopup(E).then(function(e){e.credential.accessToken,e.user}).catch(function(e){var t=e.code,n=e.message,r=e.email,o=e.credential;console.log("error with Facebook sign in: Message: "+n+"Code: "+t+" email: "+r);a.props.createErrorMessage("There was en error signing in with Facebook. See the log for detailed information.","Toast"),console.log(o)})},a.loginClicked=function(){var e=a.state,t=e.email,n=e.password;m.auth().signInWithEmailAndPassword(t,n).catch(function(e){var t="Error logging in! "+e.code+" "+e.message;a.props.createErrorMessage(t,"Toast")})},a.state={email:"",password:""},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){p(this.props.history)}},{key:"render",value:function(){var e=this;return r.a.createElement(f.Page,{className:"page"},r.a.createElement("img",{id:"logoStartscreen",src:"logo.png",alt:"Soundy's logotype"}),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.loginClicked()}},r.a.createElement("p",null,r.a.createElement(f.Input,{value:this.state.email,onChange:function(t){e.setState({email:t.target.value})},type:"email",modifier:"underbar",float:!0,placeholder:"Email",style:{width:"80vw"}})),r.a.createElement("p",null,r.a.createElement(f.Input,{value:this.state.password,onChange:function(t){e.setState({password:t.target.value})},modifier:"underbar",type:"password",float:!0,placeholder:"Password",style:{width:"80vw"}})),r.a.createElement("div",{className:"border"}),r.a.createElement("p",null,r.a.createElement(f.Button,{onClick:this.loginClicked,modifier:"underbar",style:{width:"60vw"}},"Log in")),r.a.createElement("input",{type:"submit",style:{visibility:"hidden",height:0,width:0}})),r.a.createElement("p",null,r.a.createElement(f.Button,{className:".fb-google-button",modifier:"underbar",style:{width:"60vw"},onClick:this.signInWithGoogle},r.a.createElement(f.Icon,{icon:"google"})," Sign in with Google")),r.a.createElement("p",null,r.a.createElement(f.Button,{className:".fb-google-button",modifier:"underbar",style:{width:"60vw"},onClick:this.signInWithFacebook},r.a.createElement(f.Icon,{icon:"facebook"})," Sign in with Facebook")),r.a.createElement("br",null),r.a.createElement("a",{href:"javascript:;",onClick:function(){e.props.history.push("/create")}},"Don't have an account? Click here"),r.a.createElement("p",{style:{marginTop:"2em"}},r.a.createElement("a",{href:"javascript:;",onClick:function(){return e.props.history.push("resetpassword")}},"Forgot your password? Click here")))}}]),t}(n.Component),v=new m.auth.GoogleAuthProvider,y=new m.auth.FacebookAuthProvider,k=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).signInWithGoogle=function(){m.auth().signInWithPopup(v).then(function(e){e.credential.accessToken,e.user}).catch(function(e){var t=e.code,n=e.message,r=e.email,o=e.credential;console.log("error with Google-sign in: Message: "+n+"Code: "+t+" email: "+r);a.props.createErrorMessage("There was en error signing in with Google. See the log for detailed information.","Toast"),console.log(o)})},a.signInWithFacebook=function(){m.auth().signInWithPopup(y).then(function(e){e.credential.accessToken,e.user}).catch(function(e){var t=e.code,n=e.message,r=e.email,o=e.credential;console.log("error with Facebook sign in: Message: "+n+"Code: "+t+" email: "+r);a.props.createErrorMessage("There was en error signing in with Facebook. See the log for detailed information.","Toast"),console.log(o)})},a.createClick=function(){var e=a.state,t=e.email,n=e.displayName,r=e.password;m.auth().createUserWithEmailAndPassword(t,r).then(function(e){e.user.updateProfile({displayName:n})}).catch(function(e){var t="Error creating user! "+e.code+" "+e.message;a.props.createErrorMessage(t,"Toast")})},a.state={email:"",displayName:"",password:""},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement(f.Page,{className:"page"},r.a.createElement("img",{id:"logoStartscreen",src:"logo.png",alt:"Soundy's logotype"}),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.loginClicked()}},r.a.createElement("p",null,r.a.createElement(f.Input,{value:this.state.email,onChange:function(t){e.setState({email:t.target.value})},modifier:"underbar",type:"email",float:!0,placeholder:"Email",style:{width:"80vw"}})),r.a.createElement("p",null,r.a.createElement(f.Input,{value:this.state.password,onChange:function(t){e.setState({password:t.target.value})},modifier:"underbar",type:"password",float:!0,placeholder:"Password",style:{width:"80vw"}})),r.a.createElement("p",null,r.a.createElement(f.Input,{value:this.state.displayName,onChange:function(t){e.setState({displayName:t.target.value})},modifier:"underbar",float:!0,placeholder:"Display Name",style:{width:"80vw"}})),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement(f.Button,{onClick:this.createClick,modifier:"underbar",style:{width:"60vw"}},"Create Account")),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement(f.Button,{className:".fb-google-button",modifier:"underbar",style:{width:"60vw"},onClick:this.signInWithGoogle},"Create account with ",r.a.createElement(f.Icon,{icon:"google"}))),r.a.createElement("p",null,r.a.createElement(f.Button,{className:".fb-google-button",modifier:"underbar",style:{width:"60vw"},onClick:this.signInWithFacebook},"Create account with ",r.a.createElement(f.Icon,{icon:"facebook"}))),r.a.createElement("input",{type:"submit",style:{visibility:"hidden",height:0,width:0}})),r.a.createElement("a",{href:"javascript:;",onClick:function(){e.props.history.push("/login")}},"Already have an account? Click here"))}}]),t}(n.Component),w=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){p(this.props.history)}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},"Loading...")}}]),t}(n.Component),O=a(14),S=a.n(O),C=a(35),j=(a(90),a(143)),M=a.n(j),T=a(144),N=a.n(T),P=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).soundClick=function(){a.state.playing?(a.refToSound.pause(),a.setState({playing:!1})):(a.refToSound.play(),a.setState({playing:!0}))},a.state={playing:!1},a.refToSound={},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderItem",value:function(e){}},{key:"handleAudioWaiting",value:function(){this.props.createErrorMessage("Slow internet connection detected.","Toast")}},{key:"render",value:function(){var e=this,t=this.props.item,a=this.state.playing,n=t.imgUrl?t.imgUrl:"https://i.imgur.com/dBmYY4M.png";return r.a.createElement(f.Card,{key:t.time},r.a.createElement("div",null,r.a.createElement("img",{src:t.photoURL,onClick:function(){return e.props.pushPage({uid:t.user,userName:t.userName,userImage:t.photoURL})},className:"profile-image-feed img-circle",alt:"profile"}),r.a.createElement("b",{onClick:function(){return e.props.pushPage({uid:t.user,userName:t.userName,userImage:t.photoURL})}},t.userName)),r.a.createElement("div",{className:"imageButtonContainer"},r.a.createElement("img",{src:n,style:{width:"100%"},alt:"placeholderText"}),r.a.createElement("button",{className:"btn",style:{opacity:"0.8"},onClick:function(){return e.soundClick()}},r.a.createElement("ons-icon",{icon:a?"pause":"play"}))),r.a.createElement("audio",{ref:function(t){e.refToSound=t},onWaiting:function(){return e.handleAudioWaiting()}},r.a.createElement("source",{src:t.url}),r.a.createElement("p",null,"Your browser does not support audio. The file can be found at"," ",r.a.createElement("a",{href:t.url},"this link"))),r.a.createElement("center",null,r.a.createElement("h4",null,t.title," ",r.a.createElement("i",null,"#",t.keyword))),r.a.createElement("p",null,"Posted ",r.a.createElement(N.a,{date:new Date(t.time)})))}}]),t}(n.Component),I=(a(91),a(56)),U=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).getUsersPost=function(e){var t=e.uid;a.db.collection("all-sounds").where("user","==",t).get().then(function(e){var t=[];e.forEach(function(e){var a=e.data();a.id=e.id,t.push(a)}),t.sort(function(e,t){return t.time-e.time}),a.setState({listOfPosts:t,hasFetched:!0})})},a.showDeletePostConfirmation=function(e,t){I.notification.confirm("Are you sure you want to delete this post?").then(function(n){n&&a.deletePost(e,t)})},a.deletePost=function(e,t){e.showSpinnerOnButton=!0,a.state.listOfPosts[t].showSpinnerOnButton=!0,a.forceUpdate();var n=e.id,r=e.storageUri;a.removeOnePost({id:n,storageUri:r}).then(function(e){e.data.completed&&a.setState({hasFetched:!1})})},a.state={hasFetched:!1,listOfPosts:[]},a.removeOnePost=m.functions().httpsCallable("removeOnePost"),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.db=m.firestore(),this.props.user&&(console.log(this.props.user),this.getUsersPost(this.props.user))}},{key:"shouldComponentUpdate",value:function(e,t){return!!t.hasFetched||(!e.user||(this.getUsersPost(e.user),!1))}},{key:"renderListItems",value:function(){var e=this;return this.state.listOfPosts.map(function(t,a){return r.a.createElement(f.ListItem,{key:t.time},r.a.createElement("div",{className:"left"},r.a.createElement("img",{src:t.imgUrl,className:"list-item__thumbnail",alt:"thumbnail"})),r.a.createElement("div",{className:"center"},r.a.createElement("strong",null,t.title,r.a.createElement("i",null," #",t.keyword))),e.props.shouldShowDeleteButton&&r.a.createElement("div",{className:"right"},r.a.createElement(f.Fab,{onClick:function(){return e.showDeletePostConfirmation(t,a)},className:"squareButton"},r.a.createElement(f.Icon,{spin:!!t.showSpinnerOnButton,icon:t.showSpinnerOnButton?"spinner":"trash"}))))})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(f.Fab,{className:"squareButton",onClick:function(){return e.setState({hasFetched:!1})}},r.a.createElement(f.Icon,{icon:"sync"})),r.a.createElement("div",{className:"userList"},r.a.createElement(f.List,null,this.renderListItems())))}}]),t}(n.Component),A=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={foo:!0},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onLoad",value:function(){var e=Object(C.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.fetchAllSounds();case 2:t();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"renderPullHook",value:function(){return r.a.createElement(f.PullHook,{onChange:this.onChange,onLoad:this.onLoad.bind(this)},"initial"===this.state.pullHookState?r.a.createElement("span",null,r.a.createElement(f.Icon,{size:35,spin:!1,icon:"ion-arrow-down-a"}),"Pull down to refresh"):"preaction"===this.state.pullHookState?r.a.createElement("span",null,r.a.createElement(f.Icon,{size:35,spin:!1,icon:"ion-arrow-up-a"}),"Release to refresh"):r.a.createElement("span",null,r.a.createElement(f.Icon,{spin:!0,icon:"sync-alt",style:{display:this.state.spinner}})))}},{key:"renderInfiniteScroller",value:function(e){var t=this,a=[];return this.props.allSounds.map(function(e,n){a.push(r.a.createElement(P,{item:e,key:e.id,createErrorMessage:t.props.createErrorMessage,pushPage:function(e){return t.props.pushPage(e)}}))}),r.a.createElement(M.a,{pageStart:0,loadMore:this.loadItems.bind(this),initialLoad:!1,hasMore:this.props.hasMore,loader:r.a.createElement("div",{className:"loader",key:0},"Loading ..."),useWindow:!1},r.a.createElement("div",null,a))}},{key:"loadItems",value:function(e){this.props.fetchAdditionalSounds()}},{key:"render",value:function(){return r.a.createElement(f.Page,null,this.renderPullHook(),this.renderInfiniteScroller())}}]),t}(n.Component),B=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"renderPage",value:function(e,t){var a=this;switch(e.component.uid){case"Feed":return r.a.createElement(A,Object.assign({key:e.component.uid},this.props,{pushPage:function(e){return a.pushPage(t,e)}}));default:return r.a.createElement(f.Page,{key:e.component.uid},r.a.createElement("div",{style:{textAlign:"left"}},r.a.createElement(f.BackButton,{onClick:function(){return t.popPage()}},"go back"),r.a.createElement("img",{src:e.component.userImage,className:"profile-image-feed img-circle",alt:"profile"}),r.a.createElement("h2",{style:{display:"inline-block"}},e.component.userName)),r.a.createElement(U,{user:e.component,shouldShowDeleteButton:!1}))}}},{key:"pushPage",value:function(e,t){e.pushPage({component:t,hasBackButton:!0})}},{key:"render",value:function(){return r.a.createElement(f.Page,null,r.a.createElement(f.Navigator,{swipeable:!0,renderPage:this.renderPage.bind(this),initialRoute:{component:{uid:"Feed"},hasBackButton:!1}}))}}]),t}(n.Component),x=(a(142),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).signOut=function(){m.auth().signOut().then(function(){}).catch(function(e){console.log("Error when signing out"+e),this.props.createErrorMessage("Error when signing out. See log for more details","AlertDialog")})},a.showRemoveAccountConfirmation=function(){I.notification.confirm("Are you sure you want to delete your account?").then(function(e){e&&a.removeAccount()})},a.removeAccount=function(){a.setState({deletingUser:!0});var e=a.state.currentUser.uid;console.log(e),a.removeUser({uid:e}).then(function(e){e.data.completed?a.signOut():a.props.createErrorMessage("Error when removing account","Toast")})},a.upload=function(){var e=m.auth().currentUser,t=a.storageRef.child("profileImages"),n=document.querySelector("#photo").files[0];if(n){a.setState({uploadText:"none",spinner:"block"});var r=e.uid,o={contentType:n.type};t.child(r).put(n,o).then(function(e){return e.ref.getDownloadURL()}).then(function(t){e.updateProfile({photoURL:t}).then(function(t){a.setState({currentUser:e,image:null,checkmark:"none",spinner:"none",selectText:"block",uploadText:"block"})}).catch(function(e){this.props.createErrorMessage("Error uploading profile image.","AlertDialog")})}).catch(console.error)}},a.selectButtonContent=function(){a.setState({checkmark:"block",selectText:"none"})},a.state={currentUser:null,name:null,photoURL:null,image:"",checkmark:"none",spinner:"none",selectText:"inherent",uploadText:"inherent",deletingUser:!1,listOfPosts:[]},a.removeUser=m.functions().httpsCallable("removeUser"),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.firebaseAuthListener=m.auth().onAuthStateChanged(function(t){t&&e.setState({currentUser:t})});var t=m.app().storage("gs://soundy-dm2518.appspot.com/");this.storageRef=t.ref(),this.db=m.firestore()}},{key:"componentWillUnmount",value:function(){this.firebaseAuthListener&&this.firebaseAuthListener()}},{key:"renderProfileImage",value:function(){var e=this.state.currentUser;return e&&null===e.photoURL?r.a.createElement("img",{src:"https://t4.ftcdn.net/jpg/02/15/84/43/240_F_215844325_ttX9YiIIyeaR7Ne6EaLLjMAmy4GvPC69.jpg",alt:"No Display Name",className:"userPhoto"}):r.a.createElement("img",{src:e&&e.photoURL,alt:e&&e.displayName,className:"userPhoto"})}},{key:"editProfileName",value:function(){var e=this,t=m.auth().currentUser;null!==this.state.name&&t.updateProfile({displayName:this.state.name}).then(function(a){e.setState({currentUser:t,name:null})}).catch(function(e){console.error("Error updating! "+e.code+" "+e.message),this.createErrorMessage("Error editing profile. See log for more details","AlertDialog")})}},{key:"render",value:function(){var e=this,t=this.state.currentUser;return this.state.deletingUser?r.a.createElement("div",{style:{paddingTop:"50%",fontSize:"2rem"}},"Deleting..."):r.a.createElement(f.Page,{className:"page"},r.a.createElement("div",{className:"top"},r.a.createElement("div",{className:"profilDetails"},r.a.createElement("div",{className:"profileNameAndImageContainer"},this.renderProfileImage(),r.a.createElement("h2",null,t&&t.displayName)),r.a.createElement("div",{className:"signOutRemoveContainer"},r.a.createElement(f.Button,{modifier:"material",onClick:this.signOut},"Sign out ",r.a.createElement(f.Icon,{icon:"sign-out-alt"})),r.a.createElement(f.Button,{modifier:"material",onClick:this.showRemoveAccountConfirmation},"Remove account ",r.a.createElement(f.Icon,{icon:"trash"}))),r.a.createElement("div",{className:"edit"},r.a.createElement("div",{className:"editName"},r.a.createElement(f.Input,{value:this.state.name,onChange:function(t){e.setState({name:t.target.value})},modifier:"underbar",float:!0,placeholder:"Update Name",className:"updateName",requried:!0}),r.a.createElement(f.Fab,{className:"squareButton",onClick:this.editProfileName.bind(this)},r.a.createElement(f.Icon,{icon:"save"}))),r.a.createElement("form",null,r.a.createElement("input",{className:"uploadImage",type:"file",name:"photo",accept:"image/*",id:"photo",onChange:this.selectButtonContent}),r.a.createElement("label",{htmlFor:"photo",className:"uploadImage"},r.a.createElement("span",{style:{display:this.state.selectText}},"Select Image"),r.a.createElement(f.Icon,{icon:"check",style:{display:this.state.checkmark}})),r.a.createElement(f.Button,{modifier:"material",onClick:this.upload,className:"uploadImage rightButton"},r.a.createElement("span",{style:{display:this.state.uploadText}},"Upload"),r.a.createElement(f.Icon,{spin:!0,icon:"sync-alt",style:{display:this.state.spinner}})))))),r.a.createElement(U,{user:this.state.currentUser,shouldShowDeleteButton:!0}))}}]),t}(n.Component)),R=a(28),D=a(147),L=a(148),F=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=function(){a.storage=m.app().storage("gs://soundy-dm2518.appspot.com/"),a.db=m.firestore()},a.startRecording=function(){a.setState({record:!0}),a.startTimer()},a.stopRecording=function(){a.setState({record:!1}),a.stopTimer()},a.uploadRecording=function(){var e=a.state,t=e.audioBlob,n=e.title,r=e.keyword;if(a.validUserInput())if(t){a.setState({uploading:!0});var o=m.auth().currentUser.uid,s=+new Date;a.props.updateImagesFromUnsplash(r).then(function(e){console.log(n),a.db.collection("all-sounds").add({user:o,time:s,title:n,keyword:r,imgUrl:e}).then(function(e){var n="sounds/"+m.auth().currentUser.uid+"/"+e.id;a.storage.ref(n).put(t).then(function(t){t.ref.getDownloadURL().then(function(n){e.update({url:n,storageUri:t.metadata.fullPath}).then(a.setState({audioBlob:null,blobURL:"",keyword:"",title:"",uploading:!1},function(){return a.props.changeTabContainerIndex(0)}))})})})}).catch(function(e){console.log("ERROR: "+e.message),a.props.createErrorMessage(e.message,"Toast")})}else a.props.createErrorMessage("A recording is required to be able to post to the Soundy feed.","Toast")},a.state={record:!1,audioBlob:null,isRecording:!1,isPaused:!1,title:"",keyword:"",time:0,uploading:!1},a.onStop=a.onStop.bind(Object(R.a)(Object(R.a)(a))),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"startTimer",value:function(){var e=this;this.timer=setInterval(function(){return e.setState({time:e.state.time+1})},1e3),setTimeout(this.stopRecording,1e4)}},{key:"stopTimer",value:function(){this.setState({time:0}),clearInterval(this.timer)}},{key:"onData",value:function(e){}},{key:"onStop",value:function(e){this.setState({blobURL:e.blobURL,audioBlob:e.blob})}},{key:"validUserInput",value:function(){return this.state.title&&0!==this.state.title.length?!(!this.state.keyword||!this.state.keyword.match(/^[a-zA-Z0-9]+$/))||(this.props.createErrorMessage("You can only write one (1) keyword, use letters and/or numbers.","Toast"),!1):(this.props.createErrorMessage("Please enter a title of your recording.","Toast"),!1)}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.blobURL,o=a.uploading;switch(this.state.record){case!1:e=r.a.createElement("ons-icon",{onClick:this.startRecording,icon:"fa-circle",size:"30px",style:{color:"red"}});break;case!0:e=r.a.createElement("ons-icon",{onClick:this.stopRecording,icon:"fa-stop-circle",size:"56px",style:{color:"red"}});break;default:e=r.a.createElement("h1",null,"Something is wrong")}return r.a.createElement(f.Page,null,r.a.createElement(D.a,{record:this.state.record,className:"sound-wave boxShadow",onStop:this.onStop,onData:this.onData,strokeColor:"#4C78FB",backgroundColor:"#ffffff"}),r.a.createElement("div",null,r.a.createElement("ons-fab",{class:"fab fab--material"},e)),r.a.createElement("br",null),r.a.createElement(L.a,{percent:10*this.state.time,style:{width:"80%"},strokeWidth:"4",strokeColor:"#80B1F7"}),r.a.createElement("p",null,this.state.time," out of 10s"),r.a.createElement("br",null),r.a.createElement("h2",null,"Listen to your recording:"),r.a.createElement("div",null,r.a.createElement("audio",{ref:"audioSource",controls:"controls",src:n})),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement(f.Input,{value:this.state.title,onChange:function(e){t.setState({title:e.target.value})},onKeyPress:function(e){13==e.which&&t.uploadRecording()},modifier:"material",float:!0,placeholder:"Title",style:{width:"80vw"}})),r.a.createElement("div",null,r.a.createElement(f.Input,{value:this.state.keyword,onChange:function(e){t.setState({keyword:e.target.value})},onKeyPress:function(e){13==e.which&&t.uploadRecording()},modifier:"material",float:!0,placeholder:"Enter 1 keyword",style:{width:"80vw"}})),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement(f.Button,{modifier:"material",onClick:this.uploadRecording,className:"uploadImage"},r.a.createElement(f.Icon,{spin:o,icon:o?"sync-alt":"fa-cloud-upload-alt",style:{display:this.state.spinner}}),r.a.createElement("span",null," Upload"))))}}]),t}(n.Component),W={config:{apiKey:"AIzaSyAJZXBhqNSQG9VplYDMM-v0cADz10r16-M",authDomain:"soundy-dm2518.firebaseapp.com",databaseURL:"https://soundy-dm2518.firebaseio.com",projectId:"soundy-dm2518",storageBucket:"soundy-dm2518.appspot.com",messagingSenderId:"431756069486"},unsplashApiKeys:{access_key:"2a745e3aed8f6d1704ea605cf1714be80d3fdf38fabf4e6c09a098b770cf97a6",secret_key:"33be076d60849f65a6bf319f8b9631b63b4ca166ae5bdbf941cfb381960564e0"}},K=a(105),_=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).fetchAllSounds=Object(C.a)(S.a.mark(function e(){var t,a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.onLine){e.next=16;break}return e.next=3,n.fetchAllUsers();case 3:return t=e.sent,a=[],e.prev=5,e.next=8,n.db.collection("all-sounds").orderBy("time","desc").limit(10).get().then(function(e){e.forEach(function(e){var n=e.data(),r=t.find(function(e){return e.uid===n.user});n.userName=r?r.displayName:"-",n.photoURL=r?r.photoURL:null,n.id=e.id,a.push(n)})}).then(function(){return n.setState({allSounds:a,status:"loaded"},function(){return n.setState({lastKnownKey:n.state.allSounds[n.state.allSounds.length-1].time})})}).catch(function(e){n.props.createErrorMessage("Error when fetching new sounds. See the log for more details","Toast"),console.log(e)});case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(5),n.props.createErrorMessage(e.t0,"Toast"),console.log(e.t0);case 14:e.next=17;break;case 16:n.props.createErrorMessage("No internet connection! :(","Toast");case 17:case"end":return e.stop()}},e,null,[[5,10]])})),n.fetchAdditionalSounds=Object(C.a)(S.a.mark(function e(){var t,a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.onLine){e.next=16;break}return e.next=3,n.fetchAllUsers();case 3:return t=e.sent,a=n.state.allSounds,e.prev=5,e.next=8,n.db.collection("all-sounds").orderBy("time","desc").startAt(n.state.lastKnownKey).limit(10).get().then(function(e){1===e.size&&(n.setState({hasMore:!1}),n.props.createErrorMessage("No more posts available.","Toast")),e.forEach(function(e){var r=e.data(),o=t.find(function(e){return e.uid===r.user});r.userName=o?o.displayName:"-",r.photoURL=o?o.photoURL:null,r.time!==n.state.lastKnownKey&&a.push(r)})}).then(function(){return n.setState({allSounds:a,status:"loaded"},function(){return n.setState({lastKnownKey:n.state.allSounds[n.state.allSounds.length-1].time})})}).catch(function(e){n.props.createErrorMessage("Error when fetching new sounds. See the log for more details","Toast"),console.log(e)});case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(5),n.props.createErrorMessage(e.t0,"Toast"),console.log(e.t0);case 14:e.next=17;break;case 16:n.props.createErrorMessage("No internet connection! :(","Toast");case 17:case"end":return e.stop()}},e,null,[[5,10]])})),n.fetchAllUsers=function(){return n.getAllUsers().then(function(e){return e.data.users}).catch(function(e){return[]})},n.signOut=function(){m.auth().signOut().then(function(){}).catch(function(e){console.log("Error when signing out"+e),n.props.createErrorMessage("Error when signing out "+e,"Toast")})};var r=new(0,a(105).default)({applicationId:W.unsplashApiKeys.access_key,secret:W.unsplashApiKeys.secret_key});return n.getAllUsers=m.functions().httpsCallable("getAllUsers"),n.state={currentUser:null,index:1,posts:[{title:"dog",postedBy:"Herman"},{title:"cat",postedBy:"OtherUser"},{title:"hat",postedBy:"David"}],unsplash:r,status:"loading",allSounds:[],lastKnownKey:"",hasMore:!0},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"updateImagesFromUnsplash",value:function(){var e=Object(C.a)(S.a.mark(function e(t){var a;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return","https://i.imgur.com/dBmYY4M.png");case 2:return e.prev=2,e.next=5,this.state.unsplash.search.photos(t,1,1);case 5:return a=e.sent,e.next=8,Object(K.toJson)(a);case 8:return a=e.sent,e.abrupt("return",a.results[0].urls.thumb);case 12:return e.prev=12,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return","https://i.imgur.com/dBmYY4M.png");case 16:case"end":return e.stop()}},e,this,[[2,12]])}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(C.a)(S.a.mark(function e(){var t;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p(this.props.history),t=m.app().storage("gs://soundy-dm2518.appspot.com/"),this.storageRef=t.ref(),this.db=m.firestore(),this.fetchAllSounds();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"changeTabContainerIndex",value:function(e){this.setState({index:e})}},{key:"renderToolbar",value:function(){return r.a.createElement(f.Toolbar,null,r.a.createElement("div",{className:"center toolbar__center toolbar__title toolbar--material__center"},r.a.createElement("img",{className:"logoHeader",src:"logo_white.png",alt:"logo"})))}},{key:"render",value:function(){var e,t=this;switch(this.state.status){case"loading":e=r.a.createElement("div",{style:{paddingTop:"50%"}},r.a.createElement(f.Icon,{spin:!0,icon:"sync-alt"}));break;case"loaded":e=r.a.createElement(B,{posts:this.state.posts,allSounds:this.state.allSounds,fetchAllSounds:function(){return t.fetchAllSounds()},createErrorMessage:function(e,a){return t.props.createErrorMessage(e,a)},fetchAdditionalSounds:function(){return t.fetchAdditionalSounds()},hasMore:this.state.hasMore});break;default:e=r.a.createElement("p",null,"something wrong")}return r.a.createElement(f.Page,{renderToolbar:this.renderToolbar},r.a.createElement(f.Tabbar,{onPreChange:function(e){var a=e.index;return t.setState({index:a})},onPostChange:function(){return console.log("postChange")},onReactive:function(){return console.log("postChange")},position:"bottom",index:this.state.index,renderTabs:function(a,n){return[{content:r.a.createElement(f.Page,{key:"Feed"},e),tab:r.a.createElement(f.Tab,{label:"Feed",icon:"fa-headphones",key:"FeedTab"})},{content:r.a.createElement(f.Page,{key:"Upload"},r.a.createElement(F,{createErrorMessage:function(e,a){return t.props.createErrorMessage(e,a)},updateImagesFromUnsplash:function(e){return t.updateImagesFromUnsplash(e)},changeTabContainerIndex:function(e){return t.changeTabContainerIndex(e)}})),tab:r.a.createElement(f.Tab,{label:"Upload",icon:"fa-microphone",key:"UploadTab"})},{content:r.a.createElement(f.Page,{key:"Profile"},r.a.createElement(x,{createErrorMessage:function(e,a){return t.props.createErrorMessage(e,a)}})),tab:r.a.createElement(f.Tab,{label:"Profile",icon:"fa-user",key:"ProfileTab"})}]}}))}}]),t}(n.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"handleCancel",value:function(){}},{key:"renderToast",value:function(){var e=this;return r.a.createElement(f.Toast,{isOpen:this.props.isOpen},r.a.createElement("div",{className:"message"},this.props.message),r.a.createElement("button",{onClick:function(){return e.props.onCancel()}},"Dismiss"))}},{key:"renderAlertDialog",value:function(){var e=this;return r.a.createElement(f.AlertDialog,{isOpen:this.props.isOpen,onCancel:function(){return e.props.onCancel()},cancelable:!0},r.a.createElement("div",{className:"alert-dialog-title"},"Warning!"),r.a.createElement("div",{className:"alert-dialog-content"},this.props.message),r.a.createElement("div",{className:"alert-dialog-footer"},r.a.createElement("button",{onClick:function(){return e.props.onCancel()},className:"alert-dialog-button"},"Cancel"),r.a.createElement("button",{onClick:function(){return e.props.onCancel()},className:"alert-dialog-button"},"Ok")))}},{key:"showError",value:function(){var e;switch(this.props.type){case"AlertDialog":e=this.renderAlertDialog();break;case"Toast":e=this.renderToast();break;default:e=this.renderAlertDialog()}return e}},{key:"render",value:function(){var e=this.showError();return r.a.createElement("span",null,e)}}]),t}(n.Component),z=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).resetPassword=function(){var e=m.auth(),t=a.state.email;e.sendPasswordResetEmail(t).then(function(){console.log(Object(R.a)(Object(R.a)(a))),a.props.createErrorMessage("Email for password reset sent. Follow instructions in the email.","Toast"),a.props.history.push("/")}).catch(function(e){console.log(e),a.props.createErrorMessage("Error entering email: "+e.code,"Toast")})},a.state={email:""},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"renderToolbar",value:function(){return r.a.createElement(f.Toolbar,null,r.a.createElement("div",{className:"center"},"Welcome"))}},{key:"render",value:function(){var e=this;return r.a.createElement(f.Page,{renderToolbar:this.renderToolbar,className:"page"},r.a.createElement("h1",null,"Soundy"),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.resetPassword()}},r.a.createElement("p",null,r.a.createElement(f.Input,{value:this.state.email,onChange:function(t){e.setState({email:t.target.value})},modifier:"underbar",type:"email",float:!0,placeholder:"Enter email to reset password",style:{width:"80vw"}})),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement(f.Button,{onClick:this.resetPassword,modifier:"underbar",style:{width:"60vw"}},"Send me an email")),r.a.createElement("input",{type:"submit",style:{visibility:"hidden",height:0,width:0}})),r.a.createElement("p",{style:{width:"80%"}},"Enter your email address to receive an email with details on how to reset your password."),r.a.createElement("a",{href:"javascript:;",onClick:function(){e.props.history.push("/login")}},"Back to the login screen"))}}]),t}(n.Component),Y=a(34),q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={errorOccured:!1,errorMessage:"",errorMessageType:""},window.addEventListener("offline",function(e){a.createErrorMessage("No internet connection detected. \nThe app won't function properly.","Toast")}),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"createErrorMessage",value:function(e,t){this.setState({errorOccured:!0,errorMessage:e,errorMessageType:t})}},{key:"cancelErrorMessage",value:function(){this.setState({errorOccured:!1,errorMessage:"",errorMessageType:""})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("header",{className:"App-header"},r.a.createElement(Y.a,{path:"/",exact:!0,component:w}),r.a.createElement(Y.a,{path:"/login",exact:!0,render:function(t){return r.a.createElement(b,Object.assign({},t,{createErrorMessage:function(t,a){return e.createErrorMessage(t,a)},cancelErrorMessage:function(){return e.cancelErrorMessage()}}))}}),r.a.createElement(Y.a,{path:"/create",exact:!0,render:function(t){return r.a.createElement(k,Object.assign({},t,{createErrorMessage:function(t,a){return e.createErrorMessage(t,a)},cancelErrorMessage:function(){return e.cancelErrorMessage()}}))}}),r.a.createElement(Y.a,{path:"/TabContainer",render:function(t){return r.a.createElement(_,Object.assign({},t,{createErrorMessage:function(t,a){return e.createErrorMessage(t,a)},cancelErrorMessage:function(){return e.cancelErrorMessage()}}))}}),r.a.createElement(Y.a,{path:"/resetpassword",exact:!0,render:function(t){return r.a.createElement(z,Object.assign({},t,{createErrorMessage:function(t,a){return e.createErrorMessage(t,a)},cancelErrorMessage:function(){return e.cancelErrorMessage()}}))}}),r.a.createElement(G,{type:this.state.errorMessageType,isOpen:this.state.errorOccured,message:this.state.errorMessage,onCancel:function(){return e.cancelErrorMessage()}})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));m.initializeApp(W.config),s.a.render(r.a.createElement(i.a,null,r.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},48:function(e,t,a){}},[[149,1,2]]]);
//# sourceMappingURL=main.4e3ab8f8.chunk.js.map